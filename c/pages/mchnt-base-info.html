<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>商户信息</title>
    <link rel="stylesheet" type="text/css" href="../lib/easyui/themes/default/easyui.css" />
    <link rel="stylesheet" type="text/css" href="../lib/easyui/themes/icon.css" />
    <link rel="stylesheet" type="text/css" href="../css/ui-base.css" />
</head>

<body style="padding: 5px 5px 5px 5px">
    <div class="page page_active" id="search-page">
        <div>
            <form id="search-fm" class="form form_search" action="/action/bm/mchnt-base-info/search" method="post">
                <table class="form__table">
                    <caption>查询商户信息</caption>
                    <tr>
                        <td>
                            <label>客户号：</label>
                        </td>
                        <td>
                            <input type="text" name="mchnt_id">
                        </td>
                        <td>
                            <label>联系人：</label>
                        </td>
                        <td>
                            <input type="text" name="linkman">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>手机：</label>
                        </td>
                        <td>
                            <input type="text" name="mobile">
                        </td>
                        <td>
                            <label>商户简称：</label>
                        </td>
                        <td>
                            <input type="text" name="mchnt_abbr">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>详细地址：</label>
                        </td>
                        <td>
                            <input type="text" name="addr">
                        </td>
                        <td>
                            <label>营业执照号：</label>
                        </td>
                        <td>
                            <input type="text" name="license_no">
                        </td>
                    </tr>
                    <tfoot>
                        <tr>
                            <td colspan="4" class="center">
                                <div style="margin:5px;"></div>
                                <a href="javascript:void(0)" class="easyui-linkbutton" data-options="iconCls:'icon-search',datagrid:'#search-dg'" style="padding:0 5px;" onclick="$$.search(this)">查询</a> &nbsp;&nbsp;
                                <a href="javascript:void(0)" class="easyui-linkbutton" data-options="iconCls:'icon-clear',datagrid:'#search-dg'" style="padding:0 5px;" onclick="$$.reset(this)">重置</a>
                            </td>
                        </tr>
                    </tfoot>
                </table>
            </form>
        </div>
        <br>
        <div id="search-dg-tb">
            <a href="#detail-page" class="easyui-linkbutton" onClick="$$.add(this, event)" data-options="plain:true,iconCls:'icon-add',form:'#detail-fm',onSuccess:$$.addSuccess">新增</a>
            <a href="#detail-page" class="easyui-linkbutton" onClick="$$.view(this, event)" data-options="plain:true,iconCls:'icon-view',datagrid:'#search-dg',form:'#detail-fm'">查看详情</a>
            <a href="#detail-page" class="easyui-linkbutton" onClick="$$.view(this, event, 'update')" data-options="plain:true,iconCls:'icon-edit',datagrid:'#search-dg',form:'#detail-fm'" data-action="update">编辑</a>
            <a href="javascript:void(0)" class="easyui-linkbutton" onClick="$$.batchSubmit(this)" data-options="plain:true,iconCls:'icon-remove',datagrid:'#search-dg',url:'/action/bm/mchnt-base-info/batch-delete',onSuccess:$$.batchSubmitSuccess" data-actions="delete">删除</a>
        </div>
        <table id="search-dg" title="商户信息" class="easyui-datagrid" style="min-width: 1000px;" data-options="toolbar:'#search-dg-tb',idField:'rec_id',transition:$$.st.transition[typeId]||[]">
            <thead>
                <tr>
                    <th data-options="field:'chk',checkbox:true"></th>
                    <th data-options="field:'mchnt_id'">客户号</th>
                    <th data-options="field:'linkman'">联系人</th>
                    <th data-options="field:'mobile'">手机</th>
                    <th data-options="field:'mchnt_abbr'">商户简称</th>
                    <!-- <th data-options="field:'telno'">联系电话</th> -->
                    <th data-options="field:'district_name'">所在地区</th>
                    <th data-options="field:'addr'">详细地址</th>
                    <th data-options="field:'mchnt_name'">商户名称</th>
                    <th data-options="field:'license_no'">营业执照号</th>
                    <th data-options="field:'expand_inst_nm'">拓展方</th>
                    <th data-options="field:'expand_nm'">拓展人</th>
                    <th data-options="field:'oper_in',formatter:formatOperIn">操作标志</th>
                    <th data-options="field:'proc_st',formatter:formatProcSt">处理状态</th>
                    <th data-options="field:'op',formatter:formatOp">操作</th>
                </tr>
            </thead>
        </table>
    </div>
    <div class="page" id="detail-page">
        <form id="detail-fm" class="form form_detail" action="/action/bm/mchnt-base-info/view" method="post" data-options="onLoad:onLoad">
            <table class="form__table">
                <caption>商户信息</caption>
                <tbody>
                    <tr>
                        <td>
                            <label>客户号：</label>
                        </td>
                        <td class="readonly">
                            <input type="text" name="mchnt_id" class="easyui-validatebox" data-options="">
                            <!-- <span class="required">*</span> -->
                        </td>
                        <td>
                            <label>联系人：</label>
                        </td>
                        <td>
                            <input type="text" name="linkman" class="easyui-validatebox" data-options="required:true">
                            <span class="required">*</span>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>手机：</label>
                        </td>
                        <td>
                            <input type="text" name="mobile" class="easyui-validatebox" data-options="required:true">
                            <span class="required">*</span>
                        </td>
                        <td>
                            <label>常用邮箱：</label>
                        </td>
                        <td>
                            <input type="text" name="email" class="easyui-validatebox" data-options="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>商户简称：</label>
                        </td>
                        <td>
                            <input type="text" name="mchnt_abbr" class="easyui-validatebox" data-options="required:true">
                            <span class="required">*</span>
                        </td>
                        <td>
                            <label>联系电话：</label>
                        </td>
                        <td>
                            <input type="text" name="telno" class="easyui-validatebox" data-options="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>所在地区：</label>
                        </td>
                        <td class="td30 clear-readonly">
                            <div>
                                <input type="text" id="province" name="province" class="easyui-combobox" data-options="editable:false,required:true,data:provinceData,onChange:onChangeProvince" style="width:80px;">
                                <input type="text" id="city" name="city" class="easyui-combobox" data-options="editable:false,required:true,data:cityData,onChange:onChangeCity" style="width:80px;">
                                <input type="text" id="district" name="district" class="easyui-combobox" data-options="editable:false,required:true" style="width:80px;">
                                <span class="required">*</span>
                            </div>
                        </td>
                        <td>
                            <label>详细地址：</label>
                        </td>
                        <td>
                            <input type="text" name="addr" class="easyui-validatebox" data-options="required:true">
                            <span class="required">*</span>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>商户名称：</label>
                        </td>
                        <td>
                            <input type="text" name="mchnt_name" class="easyui-validatebox" data-options="required:true">
                            <span class="required">*</span>
                        </td>
                        <td>
                            <label>营业执照号：</label>
                        </td>
                        <td>
                            <input type="text" name="license_no" class="easyui-validatebox" data-options="required:true">
                            <span class="required">*</span>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>营业执照期限：</label>
                        </td>
                        <td>
                            <input type="text" name="license_date" class="easyui-validatebox Wdate" data-options="" onfocus="WdatePicker()">
                        </td>
                        <td>
                            <label>注册地址：</label>
                        </td>
                        <td>
                            <input type="text" name="license_addr" class="easyui-validatebox" data-options="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>经营范围：</label>
                        </td>
                        <td>
                            <input type="text" name="business_scope" class="easyui-validatebox" data-options="">
                        </td>
                        <td>
                            <label>证件类型：</label>
                        </td>
                        <td>
                            <select name="cert_type" class="easyui-validatebox" data-options="required:true" id="cert_type">
                            </select>
                            <span class="required">*</span>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>证件姓名：</label>
                        </td>
                        <td>
                            <input type="text" name="cert_name" class="easyui-validatebox" data-options="required:true">
                            <span class="required">*</span>
                        </td>
                        <td>
                            <label>证件号码：</label>
                        </td>
                        <td>
                            <input type="text" name="cert_id" class="easyui-validatebox" data-options="required:true">
                            <span class="required">*</span>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>证件有效期：</label>
                        </td>
                        <td>
                            <input type="text" name="cert_date" class="easyui-validatebox Wdate" data-options="" onfocus="WdatePicker()">
                        </td>
                        <td>
                            <label>组织机构代码：</label>
                        </td>
                        <td>
                            <input type="text" name="org_code" class="easyui-validatebox" data-options="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>备注：</label>
                        </td>
                        <td colspan="3">
                            <input type="text" name="remark" class="easyui-validatebox" style="width: 90%;" data-options="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>拓展方：</label>
                        </td>
                        <td>
                            <input type="text" name="expand_inst_id" class="easyui-combobox" style="width: 173px;" data-options="required:true" id="expand_inst_id">
                            <span class="required">*</span>
                        </td>
                        <td>
                            <label>拓展人：</label>
                        </td>
                        <td>
                            <input type="text" name="expand_id" class="easyui-combobox" style="width: 173px;" data-options="required:true" id="expand_id">
                            <span class="required">*</span>
                        </td>
                    </tr>
                    <tr class="readonly invisible visible-view visible-check1">
                        <td>
                            <label>记录编号：</label>
                        </td>
                        <td>
                            <input type="text" name="rec_id">
                        </td>
                        <td>
                            <label>操作标志/处理状态：</label>
                        </td>
                        <td>
                            <input type="text" name="oper_in" style="width: 100px;">
                            <input type="text" name="proc_st" style="width: 100px;">
                            <!-- <select name="oper_in">
                            </select>
                            <select name="proc_st">
                            </select> -->
                        </td>
                    </tr>
                    <tr class="readonly readonly invisible visible-view visible-check1">
                        <td>
                            <label>创建人：</label>
                        </td>
                        <td>
                            <input type="text" name="created_by">
                        </td>
                        <td>
                            <label>创建时间：</label>
                        </td>
                        <td>
                            <input type="text" name="created_time">
                        </td>
                    </tr>
                    <tr class="readonly invisible visible-view visible-check1">
                        <td>
                            <label>最后修改人：</label>
                        </td>
                        <td>
                            <input type="text" name="last_modified_by">
                        </td>
                        <td>
                            <label>最后修改时间：</label>
                        </td>
                        <td>
                            <input type="text" name="last_modified_time">
                        </td>
                    </tr>
                    <tr class="readonly invisible visible-view visible-check1">
                        <td>
                            <label>最后审核人：</label>
                        </td>
                        <td>
                            <input type="text" name="last_checked_by">
                        </td>
                        <td>
                            <label>最后审核时间：</label>
                        </td>
                        <td>
                            <input type="text" name="last_checked_time">
                        </td>
                    </tr>
                    <tr class="readonly invisible visible-view visible-check1">
                        <td>
                            <label>审核通过或不通过原因：</label>
                        </td>
                        <td colspan="3" class="editable-check1">
                            <input type="text" name="checked_reason" class="easyui-validatebox" style="width:100%;" data-options="">
                        </td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="4">
                            <div style="margin:5px;"></div>
                            <a href="javascript:void(0)" class="easyui-linkbutton invisible visible-create" data-options="iconCls:'icon-ok',url:'/action/bm/mchnt-base-info/create',datagrid:'#search-dg',onSuccess:$$.submitSuccess" style="padding:0 5px;" onclick="$$.submit(this)">新增提交</a>
                            <a href="javascript:void(0)" class="easyui-linkbutton invisible visible-update" data-options="iconCls:'icon-ok',url:'/action/bm/mchnt-base-info/update',datagrid:'#search-dg',onSuccess:$$.submitSuccess" style="padding:0 5px;" onclick="$$.submit(this)">编辑提交</a>
                            <a href="javascript:void(0)" class="easyui-linkbutton" data-options="iconCls:'icon-return'" style="padding:0 5px;" onclick="$$.back(this)">返回</a>
                        </td>
                    </tr>
                </tfoot>
            </table>
        </form>
    </div>
    <script type="text/javascript" src="../lib/jquery/jquery.min.js"></script>
    <script type="text/javascript" src="../lib/easyui/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="../lib/My97DatePicker/WdatePicker.js"></script>
    <script type="text/javascript" src="../js/select2.js"></script>
    <script type="text/javascript" src="../js/base.js"></script>
    <script type="text/javascript" src="../js/st.js"></script>
    <script type="text/javascript" src="../js/param.js"></script>
    <script type="text/javascript" src="../js/district.js"></script>
    <script type="text/javascript">
    var query = $$.parseQueryString();
    var typeId = $$.st.alias['mchnt_base_info'];
    var provinceData = xProvinceCityDistrict['province'];
    var cityData = xProvinceCityDistrict['city']['43'];

    function onChangeProvince(newValue, oldValue) {
        if (newValue) {
            $('#city').combobox('clear').combobox('loadData', xProvinceCityDistrict['city'][newValue]);
            $('#district').combobox('clear');
        }
    }

    function onChangeCity(newValue, oldValue) {
        if (newValue) {
            var province = $('#province').combobox('getValue');
            if (province) {
                $('#district').combobox('clear').combobox('loadData', xProvinceCityDistrict['district'][province + newValue]);
            }
        }
    }

    function onLoad(data) {
        $('#province').combobox('clear').combobox('setValue', data.data.province);
        $('#city').combobox('clear').combobox('setValue', data.data.city);
        $('#district').combobox('clear').combobox('setValue', data.data.district);
    }

    function formatOperIn(value, rowData, rowIndex) {
        return $$.formatField($$.st.operIn[typeId], value);
    }

    function formatProcSt(value, rowData, rowIndex) {
        return $$.formatField($$.st.procSt[typeId], value);
    }

    function formatOp(value, rowData, rowIndex) {
        var queryString = $.param({
            mchnt_id: rowData.mchnt_id
        }).replace(/\+/g, '%20');

        var s = '<a href="mchnt-param.html?' + queryString + '" target="_blank">商户参数</a>';
        s += '&nbsp;|&nbsp;<a href="term-info.html?' + queryString + '" target="_blank">终端管理</a>';
        s += '&nbsp;|&nbsp;<a href="mchnt-elec-info.html?' + queryString + '" target="_blank">电子资料</a>';

        return s;
    }

    function initCombobox() {
        $$.request('/action/bm/expand-inst/list', {}, function(data) {
            $('#expand_inst_id').combobox('loadData', data.rows);
        });

        $$.request('/action/bm/expand/list', {}, function(data) {
            $('#expand_id').combobox('loadData', data.rows);
        });
    }

    $(function() {
        $('#cert_type').select2().select2('loadData', $$.param['cert_type']);
        initCombobox();
    });
    </script>
</body>

</html>
