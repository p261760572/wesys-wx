<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>我的银行卡</title>
    <link rel="stylesheet" href="../js/lib/weuijs/style/weuijs.min.css">
    <link rel="stylesheet" href="../css/ui-base.css">
</head>

<body>
	<div class="weui-cells" id="card-list">
		<div class="searchbar-result">
		
		</div>
		<a class="weui-cell weui-cell_access" href="add-bank-card.html">
			<div class="weui-cell__hd">
				<i class="icon-plus" style="width: 60px; height: 60px;"></i>
			</div>
			<div class="weui-cell__bd">
				<h4 class="weui-media-box__title">
					<p>添加银行卡</p>
				</h4>
			</div>
		</a>  
  	</div>
    <script type="text/javascript" src="../js/lib/zepto.min.js"></script>
    <script type="text/javascript" src="../js/lib/weuijs/weuijs.min.js"></script>
    <script id="card-templ" type="text/html">
        {{each rows as row i}}
        <div class="weui-cell weui-cell_access">
			<div class="weui-cell__hd">
				<i class="icon-bank-card" style="width: 60px; height: 60px;"></i>
			</div>
			<div class="weui-cell__bd">
				<h4 class="weui-media-box__title">
				<p>{{row.bank_nm}}</p>
				<p>{{row.bank_acct_no | formatCardNo}}</p>
				</h4>
			</div>
        </div>    
        {{/each}}
    </script>
    <script type="text/javascript">
		
	function onSearch(param, success, error) {
        var queryParams = param;
        $$.request('/action/as-user-card-info/list', queryParams, {
            success: function(data) {
                if (data.errcode == 0) {
                    success(data.rows);
                } else {
					
                }
            },
            error: function() {
                error();
            }
        });
    }
		
    $(function() {
        weui.searchPage('#card-list', {
			resultTpl: '#card-templ',
			loader: onSearch,
			onInput: function() {
				console.log(this, arguments);
			},
			onClickItem: function(row) {
				console.log(this, arguments);
				weui.page.back();
			}
		}).search();
    });
    </script>
</body>

</html>
