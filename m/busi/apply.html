<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>业务申请</title>
    <link rel="stylesheet" href="../js/lib/weuijs/style/weuijs.min.css">
    <style type="text/css">
    body {
        background-color: #f8f8f8;
    }
    
    .weui-cell__bd {
        position: relative;
    }
    </style>
</head>

<body>
    <div id="flow">
        <div class="flow__step" title="填写基本信息">
            <!-- 填写基本信息开始 -->
            <div class="weui-cells__title">联系信息</div>
            <div class="weui-cells weui-cells_form">
                <div class="weui-cell">
                    <div class="weui-cell__hd">
                        <label class="weui-label">联系人姓名</label>
                    </div>
                    <div class="weui-cell__bd">
                        <input class="weui-input" name="contact_name" type="text" placeholder="请输入联系人姓名">
                    </div>
                </div>
                <div class="weui-cell">
                    <div class="weui-cell__hd">
                        <label class="weui-label">手机号</label>
                    </div>
                    <div class="weui-cell__bd">
                        <input class="weui-input" name="tel_no" type="tel" placeholder="请输入手机号">
                    </div>
                </div>
                <div class="weui-cell">
                    <div class="weui-cell__hd">
                        <label class="weui-label">常用邮箱</label>
                    </div>
                    <div class="weui-cell__bd">
                        <input class="weui-input" name="mail" type="text" placeholder="请输入常用邮箱">
                    </div>
                </div>
            </div>
            <div class="weui-cells__title">经营信息</div>
            <div class="weui-cells weui-cells_form">
                <div class="weui-cell">
                    <div class="weui-cell__hd">
                        <label class="weui-label">商户名称</label>
                    </div>
                    <div class="weui-cell__bd">
                        <input class="weui-input" name="merchant_name" type="text" placeholder="请输入商户名称">
                    </div>
                </div>
                <!--div class="weui-cell">
                    <div class="weui-cell__hd">
                        <label class="weui-label">联系电话</label>
                    </div>
                    <div class="weui-cell__bd">
                        <input class="weui-input" type="tel" placeholder="请输入联系电话">
                    </div>
                </div-->
                <div class="weui-cell">
                    <div class="weui-cell__hd">
                        <label class="weui-label">所在地区</label>
                    </div>
                    <div class="weui-cell__bd">
                        <input class="weui-input" id="district" name="city" type="text" placeholder="请选择所在地区" readonly>
                    </div>
                </div>
                <div class="weui-cell">
                    <div class="weui-cell__hd">
                        <label class="weui-label">详细地址</label>
                    </div>
                    <div class="weui-cell__bd">
                        <input class="weui-input" name="address" type="text" placeholder="请输入详细地址">
                    </div>
                </div>
            </div>
            <!-- 填写基本信息结束 -->
        </div>
        
        <div class="flow__step" title="填写商户信息">
            <!-- 填写商户信息开始 -->
            <!-- <div class="weui-cells__title">营业执照</div> -->
            <div class="weui-cells weui-cells_form">
                <div class="weui-cell weui-cell_switch">
                    <div class="weui-cell__bd">营业执照</div>
                    <div class="weui-cell__ft">
                        <input class="weui-switch" type="checkbox" checked="" id="s10">
                    </div>
                </div>
                <div class="weui-cell">
                    <div class="weui-cell__bd">
                        <div class="weui-uploader">
                            <div class="weui-uploader__hd">
                                <p class="weui-uploader__title">营业执照正面照片</p>
                            </div>
                            <div class="weui-uploader__bd">
                                <ul class="weui-uploader__files">
                                   <!-- <li class="weui-uploader__file" style="background-image:url(./images/pic_160.png)"></li>
                            		<li class="weui-uploader__file" style="background-image:url(./images/pic_160.png)"></li> -->
                                </ul>
                                <div class="weui-uploader__input-box">
                                    <input id="uploaderInput" class="weui-uploader__input" type="file" accept="image/*" multiple>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--div class="weui-cell">
                    <div class="weui-cell__hd">
                        <label class="weui-label">商户名称</label>
                    </div>
                    <div class="weui-cell__bd">
                        <input class="weui-input" type="text" placeholder="请输入商户名称">
                    </div>
                </div-->
                <div class="weui-cell">
                    <div class="weui-cell__hd">
                        <label class="weui-label">营业执照号</label>
                    </div>
                    <div class="weui-cell__bd">
                        <input class="weui-input" name="contact_name" type="text" placeholder="请输入营业执照号">
                    </div>
                </div>
            </div>
            <div class="weui-cells__title">企业法人/证件持有人</div>
            <div class="weui-cells weui-cells_form">
                <div class="weui-cell weui-cell_select weui-cell_select-after">
                    <div class="weui-cell__hd">
                        <label for="" class="weui-label">证件类型</label>
                    </div>
                    <div class="weui-cell__bd">
                        <select class="weui-select" name="select2">
                            <option value="1">身份证</option>
                            <option value="2">护照</option>
                        </select>
                    </div>
                </div>
                <div class="weui-cell">
                    <div class="weui-cell__bd">
                        <div class="weui-uploader">
                            <div class="weui-uploader__hd">
                                <p class="weui-uploader__title">身份证正面照片</p>
                            </div>
                            <div class="weui-uploader__bd">
                                <ul class="weui-uploader__files">
                                    <!-- <li class="weui-uploader__file" style="background-image:url(./images/pic_160.png)"></li>
                            <li class="weui-uploader__file" style="background-image:url(./images/pic_160.png)"></li>-->
                                </ul>
                                <div class="weui-uploader__input-box">
                                    <input class="weui-uploader__input" type="file" accept="image/*" multiple>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="weui-cell">
                    <div class="weui-cell__bd">
                        <div class="weui-uploader">
                            <div class="weui-uploader__hd">
                                <p class="weui-uploader__title">身份证反面照片</p>
                            </div>
                            <div class="weui-uploader__bd">
                                <ul class="weui-uploader__files">
                                    <!-- <li class="weui-uploader__file" style="background-image:url(./images/pic_160.png)"></li>
                            <li class="weui-uploader__file" style="background-image:url(./images/pic_160.png)"></li>-->
                                </ul>
                                <div class="weui-uploader__input-box">
                                    <input class="weui-uploader__input" type="file" accept="image/*" multiple>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="weui-cell">
                    <div class="weui-cell__hd">
                        <label class="weui-label">证件姓名</label>
                    </div>
                    <div class="weui-cell__bd">
                        <input class="weui-input" name="ctfc_name" type="text" placeholder="请输入证件姓名">
                    </div>
                </div>
                <div class="weui-cell">
                    <div class="weui-cell__hd">
                        <label class="weui-label">证件号码</label>
                    </div>
                    <div class="weui-cell__bd">
                        <input class="weui-input" name="ctfc_cd" type="text" placeholder="请输入证件号码">
                    </div>
                </div>
            </div>
            <!-- 填写商户信息结束 -->
        </div>
        
        <div class="flow__step" title="填写结算信息">
            <!-- 填写结算信息开始 -->
            <div class="weui-cells__title">开通业务</div>
            <div class="weui-cells weui-cells_checkbox">
                <div>
                    <label class="weui-cell weui-check__label" for="s11">
                        <div class="weui-cell__hd">
                            <input type="checkbox" class="weui-check" name="checkbox1" id="s11">
                            <i class="weui-icon-checked"></i>
                        </div>
                        <div class="weui-cell__bd">
                            <p>银行卡收单</p>
                        </div>
                    </label>
                    <div class="weui-cell" style="display: none;">
                        <div class="weui-cell__hd">
                            <label for="" class="weui-label">借记卡手续费</label>
                        </div>
                        <div class="weui-cell__bd">
                            <input class="weui-input" name="fee_algo" type="text" id="fee_algo" placeholder="请选择借记卡手续费">
                        </div>
                    </div>
                    <div class="weui-cell" style="display: none;">
                        <div class="weui-cell__hd">
                            <label for="" class="weui-label">贷记卡手续费</label>
                        </div>
                        <div class="weui-cell__bd">
                            <input class="weui-input" name="credit_fee_algo" type="text" id="credit_fee_algo" placeholder="请选择贷记卡手续费">
                        </div>
                    </div>
                </div>
                <div>
                    <label class="weui-cell weui-check__label" for="s12">
                        <div class="weui-cell__hd">
                            <input type="checkbox" name="checkbox1" class="weui-check" id="s12">
                            <i class="weui-icon-checked"></i>
                        </div>
                        <div class="weui-cell__bd">
                            <p>当面付</p>
                        </div>
                    </label>
                    <div class="weui-cell weui-cell_vcode" style="display: none;">
                        <div class="weui-cell__hd">
                            <label for="" class="weui-label">手续费</label>
                        </div>
                        <div class="weui-cell__bd">
                            <input class="weui-input" name="dmf_fee_algo" type="text" placeholder="请输入手续费千分比">
                        </div>
                        <div class="weui-cell__ft">
                            <button class="weui-vcode-btn">‰</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="weui-cells__title">结算账户</div>
            <div class="weui-cells weui-cells_form">
                <div class="weui-cell weui-cell_select weui-cell_select-after">
                    <div class="weui-cell__hd">
                        <label for="" class="weui-label">账户类型</label>
                    </div>
                    <div class="weui-cell__bd">
                        <select class="weui-select" name="select2">
                            <option value="1">对公账户</option>
                            <option value="2">对私账户</option>
                        </select>
                    </div>
                </div>
                <div class="weui-cell">
                    <div class="weui-cell__bd">
                        <div class="weui-uploader">
                            <div class="weui-uploader__hd">
                                <p class="weui-uploader__title">账户正面照片</p>
                            </div>
                            <div class="weui-uploader__bd">
                                <ul class="weui-uploader__files">
                                    <!-- <li class="weui-uploader__file" style="background-image:url(./images/pic_160.png)"></li>
                            <li class="weui-uploader__file" style="background-image:url(./images/pic_160.png)"></li>-->
                                </ul>
                                <div class="weui-uploader__input-box">
                                    <input class="weui-uploader__input" type="file" accept="image/*" multiple>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="weui-cell">
                    <div class="weui-cell__hd">
                        <label class="weui-label">账户户名</label>
                    </div>
                    <div class="weui-cell__bd">
                        <input class="weui-input" name="account_name" type="text" placeholder="请输入账户户名">
                    </div>
                </div>
                <div class="weui-cell">
                    <div class="weui-cell__hd">
                        <label class="weui-label">银行账号</label>
                    </div>
                    <div class="weui-cell__bd">
                        <input class="weui-input" name="account" type="text" placeholder="请输入银行账号">
                    </div>
                </div>
                <!--div class="weui-cell">
                    <div class="weui-cell__hd">
                        <label for="" class="weui-label">开户银行</label>
                    </div>
                    <div class="weui-cell__bd">
                        <input class="weui-input" type="text" placeholder="请选择开户银行">
                    </div>
                </div>
                <div class="weui-cell">
                    <div class="weui-cell__hd">
                        <label for="" class="weui-label">开户银行城市</label>
                    </div>
                    <div class="weui-cell__bd">
                        <input class="weui-input" type="text" placeholder="请选择开户银行城市">
                    </div>
                </div-->
                <div class="weui-cell">
                    <div class="weui-cell__hd">
                        <label for="" class="weui-label">开户支行</label>
                    </div>
                    <div class="weui-cell__bd">
                        <input class="weui-input" type="text" name="subbranch_name" id="subbranch_name" placeholder="请选择开户支行">
                    </div>
                </div>
            </div>
            <!-- 填写结算信息结束 -->
        </div>
        <div class="flow__step" title="确认提交" id="save_all">
            <div class="weui-cells__title">基本信息</div>
            <div class="weui-form-preview">
                <div class="weui-form-preview__hd">
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">联系信息</label>
                    </div>
                </div>
                <div class="weui-form-preview__bd">
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">联系人姓名</label>
                        <span class="weui-form-preview__value" name="contact_name"></span>
                    </div>
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">手机号</label>
                        <span class="weui-form-preview__value" name="tel_no">手机号</span>
                    </div>
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">常用邮箱</label>
                        <span class="weui-form-preview__value" name="mail">常用邮箱</span>
                    </div>
                </div>
            </div>
            <!-- <br> -->
            <div class="weui-form-preview">
                <div class="weui-form-preview__hd">
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">经营信息</label>
                    </div>
                </div>
                <div class="weui-form-preview__bd">
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">商户名称</label>
                        <span class="weui-form-preview__value" name="merchant_name">商户名称</span>
                    </div>
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">联系电话</label>
                        <span class="weui-form-preview__value" name="phone">联系电话</span>
                    </div>
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">所在地区</label>
                        <span class="weui-form-preview__value" name="city">所在地区</span>
                    </div>
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">详细地址</label>
                        <span class="weui-form-preview__value" name="address">详细地址</span>
                    </div>
                </div>
                <div class="weui-form-preview__ft">
                    <a class="weui-form-preview__btn weui-form-preview__btn_primary" href="javascript:" onclick="flow.start(0)">修改</a>
                </div>
            </div>
            <div class="weui-cells__title">商户信息</div>
            <div class="weui-form-preview">
                <div class="weui-form-preview__hd">
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">营业执照</label>
                    </div>
                </div>
                <div class="weui-form-preview__bd">
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">营业执照正面照片</label>
                        <span class="weui-form-preview__value">营业执照正面照片</span>
                    </div>
                    <!--div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">商户名称</label>
                        <span class="weui-form-preview__value">商户名称</span>
                    </div-->
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">营业执照号</label>
                        <span class="weui-form-preview__value">营业执照号</span>
                    </div>
                </div>
            </div>
            <!-- <br> -->
            <div class="weui-form-preview">
                <div class="weui-form-preview__hd">
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">企业法人/证件持有人</label>
                    </div>
                </div>
                <div class="weui-form-preview__bd">
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">身份证正面照片</label>
                        <span class="weui-form-preview__value">身份证正面照片</span>
                    </div>
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">身份证反面照片</label>
                        <span class="weui-form-preview__value">身份证反面照片</span>
                    </div>
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">证件姓名</label>
                        <span class="weui-form-preview__value">证件姓名</span>
                    </div>
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">证件号码</label>
                        <span class="weui-form-preview__value">证件号码</span>
                    </div>
                </div>
                <div class="weui-form-preview__ft">
                    <a class="weui-form-preview__btn weui-form-preview__btn_primary" href="javascript:" onclick="flow.start(1)">修改</a>
                </div>
            </div>
            <div class="weui-cells__title">结算信息</div>
            <div class="weui-form-preview">
                <div class="weui-form-preview__hd">
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">开通业务</label>
                    </div>
                </div>
                <div class="weui-form-preview__bd">
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">银行卡收单</label>
                        <span class="weui-form-preview__value">借记卡手续费/贷记卡手续费</span>
                    </div>
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">当面付</label>
                        <span class="weui-form-preview__value">手续费</span>
                    </div>
                </div>
            </div>
            <!-- <br> -->
            <div class="weui-form-preview">
                <div class="weui-form-preview__hd">
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">结算账户</label>
                    </div>
                </div>
                <div class="weui-form-preview__bd">
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">账户类型</label>
                        <span class="weui-form-preview__value">账户类型</span>
                    </div>
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">账户正面照片</label>
                        <span class="weui-form-preview__value">账户正面照片</span>
                    </div>
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">开户名称</label>
                        <span class="weui-form-preview__value">开户名称</span>
                    </div>
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">开户银行</label>
                        <span class="weui-form-preview__value">开户银行</span>
                    </div>
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">开户银行城市</label>
                        <span class="weui-form-preview__value">开户银行城市</span>
                    </div>
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">开户支行</label>
                        <span class="weui-form-preview__value">开户支行</span>
                    </div>
                    <div class="weui-form-preview__item">
                        <label class="weui-form-preview__label">银行账号</label>
                        <span class="weui-form-preview__value">银行账号</span>
                    </div>
                </div>
                <div class="weui-form-preview__ft">
                    <a class="weui-form-preview__btn weui-form-preview__btn_primary" href="javascript:" onclick="flow.start(2)">修改</a>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript" src="../js/lib/zepto.js"></script>
    <script type="text/javascript" src="../js/lib/weuijs/weuijs.js"></script>
    <script type="text/javascript" src="../js/district.js"></script>
    <script type="text/javascript">
		
    var flow = weui.flow('#flow', {
        finishText: '确认提交',
        nextText: '保存并下一步',
        previousText: '上一步',
        onStepChanging: function(currentIndex, newIndex) {
            console.log(arguments);
        },
        onStepChanged: function(newIndex, currentIndex) {
            console.log(arguments);
        },
        onFinishing: function(currentIndex) {
            console.log(arguments);
        },
        onFinished: function(currentIndex) {
            console.log(arguments);
        }
    });
		
    $('#s10,#s11,#s12').on('change', function() {
        if ($(this).prop('checked')) {
            $(this).closest('.weui-cell').siblings().show();
        } else {
            $(this).closest('.weui-cell').siblings().hide();
        }
    });
		
	$('#district').on('click', function() {
		weui.picker(districtData,
						{
							valueField: 'value',
							textField: 'text',
							className: 'custom-classname',
							onChange: function(result) {
								console.log(result)
							},
							onConfirm: function(result) {
								console.log(result);
								//$(this).html(result[0].text+result[1].text+result[2].text);
							},
							id: 'DistrictPicker'
						})
	});
		
	$(function(){
		$('input').blur(function(){
			var ele_name = $(this).attr('name');
			var ele_value = $(this).val();
			if(ele_name != undefined) {
				console.log(ele_name);
				$('#save_all').find('span[name='+ele_name+']').html(ele_value);
			}
		});
		
		$$.request('/action/ms/parameter/list', {
				debit_fee_algo: '1',
				credit_fee_algo: '1',
				account_bank: '1'
			}, function(data) {
				if (data.errcode == 0) {
					$('#fee_algo').on('click', function() {
						weui.picker(data.debit_fee_algo,
										{
											valueField: 'value',
											textField: 'label',
											className: 'custom-classname',
											onChange: function(result) {
												console.log(result)
											},
											onConfirm: function(result) {
												console.log(result)
											},
											id: 'FeePicker'
										})
					});
					
					$('#credit_fee_algo').on('click', function() {
						weui.picker(data.credit_fee_algo,
										{
											valueField: 'value',
											textField: 'text',
											className: 'custom-classname',
											onChange: function(result) {
												console.log(result)
											},
											onConfirm: function(result) {
												console.log(result)
											},
											id: 'CreditPicker'
										})
					});
					
					$('#subbranch_name').on('click', function() {
						var select2 = weui.select2({
							data: [],
							queryParams: {},
            				rowsName: 'rows',
							url: '',
							loader: function(param, success, error) {
								var queryParams = $.extend(options.queryParams, param);

								$$.request(options.url, queryParams, {
									success: function(data) {
										if (data.errcode == 0) {
											success(data[options.rowsName]);
										} else {
											weui.alert(data.errmsg, error, {
												title: '提示'
											});
										}
									},
									error: function() {
										error();
									}
								})
							},
							onClickItem: function(row) {
								console.log(arguments);
								var opts = this.options;
                				$('#subbranch_name').val(row[opts.textField]).attr('data-value', row[opts.valueField]);
							}
						});
					});
				}
		});
	})
    </script>
</body>

</html>
